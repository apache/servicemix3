<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!-- START SNIPPET: jndi -->
<beans>

  <!-- JMX server and connector -->
  <bean id="mbeanServer" class="org.springframework.jmx.support.MBeanServerFactoryBean">
    <property name="locateExistingServerIfPossible" value="true"/>
  </bean>
  <bean id="registry" class="mx4j.tools.naming.NamingService" init-method="start">
    <property name="port" value="1099"/>
  </bean>
  <bean id="serverConnector" class="org.springframework.jmx.support.ConnectorServerFactoryBean" depends-on="registry">
    <property name="objectName" value="connector:name=rmi"/>
    <property name="serviceUrl" value="service:jmx:rmi:///jndi/rmi://localhost:1099/jmxrmi"/>
    <property name="threaded" value="true"/>
    <property name="daemon" value="true"/>
    <property name="environment">
      <map>
        <!-- Uncomment the following line to enable authentication for jmx
        <entry key="jmx.remote.authenticator" value-ref="jmxRemoteAuthenticator" />
         -->
      </map>
    </property>
  </bean>
  <bean id="jmxRemoteAuthenticator" class="mx4j.tools.remote.PasswordAuthenticator">
    <constructor-arg>
      <bean factory-method="getInputStream" factory-bean="jmxRemotePasswords" />
    </constructor-arg>
  </bean>
  <bean id="jmxRemotePasswords"  factory-method="getResource" factory-bean="resourceLoader">
    <constructor-arg value="classpath:passwords.txt"/>
  </bean>
  <bean id="resourceLoader" class="org.springframework.core.io.DefaultResourceLoader" />

</beans>
<!-- END SNIPPET: jndi -->
